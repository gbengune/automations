created by : O.Aremu
        on: July 2024
Repository source : path/to/python/module/project_mfm_monitoring
Airflow DAG: Project_mfm_website_scraper
DAG module: project_mfm_dag.py.py
DAG Status: active

There are 2 tasks associated with this DAG.
Although these tasks run after eachother in Airflow, they run independent from eachother because each time
    the dag is run, Task 2 checks the global table to see if there are new datasets, if new datasets are
    found then they are historised and updated, otherwise nothing is done. Task 1 checks the website for new datasets
    comparing the datasets found in website to those already recorded in the bridge table.

The Procedure:
Task 1 (mfm_importer.py):
    -this scrapes the datasets from the project website using the contents of project_mfm_bridge
    -scraped datasets will be written into the db_name.schemaname as tables belonging to individual Bundeslaender
    -the contents of the tables will then be inserted into global table project_mfm
    -After inserts above, the single tables will be deleted
    -A timestamp wil be inserted in the bridge table for the german State using date in dataset's name

Task 2 (project_historize.py):
    Note: Newly introduced columns from website have to be added to the sql change query
    -this checks for "cell-level changes" for new datasets using "id" inserted in the global table
    -It builds a list of date ranges
        e.g [[202304,202307],[202307,202401],[202401,202404],[202404]]
        +so it loops through each "paired" list setting [0] as previous date and [1] as present date
        +it then historises id datasets in paired dates till the last unpaired current date list.
        +for the most current date[202404], a second processing is done after the initial historisation.
            An update will be done on column "change_to" to replace previously present dates
            with that of the newest current dates in the "elif" loop. this update will set all changed rows
            to "999999", all previously non-existing ids to "888888" and the actual value to "True".

    -After the above is complete, a metadata will be generated and the global table will get commented upon.